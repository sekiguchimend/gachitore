```md
# 画面別 機能概要（Flutterアプリ）

## 1. Login（ログイン）画面
### 目的
- Supabase Authでユーザー認証し、以降の画面フローを確定する。

### 主な機能
- ログイン（メール/パスワード or OTP 等。実装方式は後で選択）
- 新規登録（必要なら）
- パスワード再設定（必要なら）

### 画面遷移ロジック
- セッション（Supabaseのセッション）が有効ならログイン画面はスキップ
- セッション有効時：
  - `user_profiles`（またはオンボーディング完了フラグ）を確認
  - 未完了 → `Onboarding / Setup` へ
  - 完了 → `Home` へ

---

## 2. Setup（初期設定/詳細設定）フロー
### 目的
- AI回答の精度を上げるための「ユーザー状態」を最初に揃える。

### 入力項目（例）
- 目標：`ダイエット / 増量 / 絞り / 健康`
- トレーニングレベル：初心者/中級/上級
- 身体情報：身長、体重（任意で体脂肪率）
- 環境：自宅/ジム、使える器具（ダンベル/ベンチ等）
- 制約：肩/腰/手首などの痛み・制限（任意）
- 食事回数（1日あたりの回数）

### 仕様ポイント
- 入力の途中保存（離脱しても再開できる）
- 完了時に `onboarding_completed = true`（もしくは必須項目充足で判定）

### 遷移
- Setup完了 → `Home`

---

## 3. Home（ホーム）画面
### 目的
- “今日やること”をチャット形式で提示し、質問もできる起点画面にする。

### 主要UI構成
- 上部：今日のサマリ（任意）
  - 体重（今日）
  - 摂取カロリー/タンパク（今日の進捗）
  - 今日のトレ有無（記録済み/未記録）
- 中央：チャット形式タイムライン
  - 「今日まだやっていないタスク（未達成）」をAIが提示
  - 例：
    - 「今日の食事ログが未入力です。まず1食分だけ入力しますか？」
    - 「胸トレの日なら、今日のメニュー案を出しますか？」
- 下部：入力欄
  - ふつうに質問できる（AIコーチに相談）
  - クイックボタン（例：`今日のメニュー` / `食事提案` / `停滞診断`）

### 機能要件
- 「未タスク判定」
  - 今日の `food` 未入力
  - 今日の `muscle（トレログ）` 未入力
  - 体重未入力（任意）
- AIの回答は履歴として保存（後から見返せる）

---

## 4. Food（食事）ページ
### 目的
- “完全入力”ではなく、目的別に固定化された項目で**入力摩擦を下げつつ継続**させる。
- 摂取状況を週/月で見える化して改善につなげる。

### 4.1 基本コンセプト：目的別テンプレ（固定項目）
- 目標別：`ダイエット / 増量 / 絞り / 健康`
- それぞれで入力項目を固定化（例）
  - ダイエット：カロリー/タンパク質中心（脂質/糖質は任意）
  - 増量：カロリー/タンパク/炭水化物中心
  - 絞り：カロリー/タンパク/食物繊維（任意）など
  - 健康：ざっくり（カロリー/タンパクのみでもOK）
- 「全部は無理」を前提に、入力は最低限で成立する設計にする。

### 4.2 食事回数設定・入力フロー
- Setupで「1日食事回数」を設定（例：3回/4回/5回）
- Food画面ではその回数分の枠を表示
  - `朝 / 昼 / 夜 / 間食…`（回数に応じて自動生成）
- 各枠に入力する内容（テンプレにより変動）
  - カロリー
  - タンパク質
  - （必要なら）脂質/炭水化物

### 4.3 過去データ閲覧（週・月）
- 期間切替：
  - 1週間 / 1か月（＋任意で3か月など）
- 表示内容
  - 日別の合計（カロリー・タンパク質など）
  - 食事回数の達成率（入力完了率）

### 4.4 グラフ表示（見やすさ優先）
- ラインチャート：日別のカロリー推移
- バーチャート：日別のタンパク質（目標達成ライン付き）
- 週平均/移動平均（任意）

---

## 5. Muscle（筋トレ）ページ
### 目的
- 現在の挙上能力（種目ごとの重量/回数など）を管理し、
  - 伸び
  - 停滞
  - 次回目標
を分かりやすくする。

### 主要機能
- 種目別の「現在値」入力・更新
  - 例：ダンベルプレス 22kg × 10回 など
- 種目一覧（検索/お気に入り）
- 種目ごとの履歴
  - 過去の最高セット
  - 推定1RM（任意）
  - 直近の伸び率

### 表示例（1種目カード）
- 現在の目安（重量×回数）
- 直近更新日
- 最高記録
- 次回目標（AI提案があれば表示）

### （任意）トレーニングログ入力
- セッションとして記録する場合
  - 日付
  - 部位
  - 種目
  - セット（重量/回数/RPE）
- MVPでは「種目ごとの現在値管理」だけでも成立

---

## 6. Settings（設定）ページ
### 目的
- アプリにありがちな設定＋コーチアプリ特有の設定をまとめる。

### 設定項目（例）
- アカウント
  - ログアウト
  - アカウント削除
- プロフィール編集
  - 目標（ダイエット/増量/絞り/健康）
  - 食事回数
  - 身長/体重/制約
- 通知（任意）
  - 食事入力リマインド
  - トレ記録リマインド
- データ
  - エクスポート（任意）
  - リセット（任意）
- 表示
  - 単位（kg固定 or lb対応など）
  - ダークモード（任意）
- ヘルプ
  - FAQ
  - 問い合わせ

---

## 7. ナビゲーション（全体）
- 初期起動：
  1) セッションなし → Login
  2) セッションあり & Setup未完 → Setup
  3) セッションあり & Setup完了 → Home
- メインタブ（例）
  - Home
  - Food
  - Muscle
  - Settings

---

## 8. ホームの“未タスク提示”の判定ルール（例）
- 今日の食事ログ：
  - 食事回数Nに対して、入力済み数 < N → 未達
- 今日のトレ記録：
  - 何らかのトレ記録がない → 未達（任意ルール）
- 体重：
  - その日の体重がない → 未達（任意ルール）

未達があればAIチャットで「次にやる一手」を提示する。
```
